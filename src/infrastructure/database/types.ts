/**
 * Типы для работы с базой данных
 *
 * Содержит интерфейсы для конфигурации, статистики и результатов операций
 */

/**
 * Конфигурация базы данных
 *
 * Используется для настройки подключения, пула соединений,
 * логирования, миграций и заполнения данными
 */
export interface DatabaseConfig {
  /** Настройки подключения к базе данных */
  connection: {
    /** URL подключения к PostgreSQL */
    url: string;
    /** SSL настройки для безопасного подключения */
    ssl: boolean | { rejectUnauthorized: boolean };
  };
  /** Настройки пула соединений */
  pool: {
    /** Минимальное количество соединений в пуле */
    min: number;
    /** Максимальное количество соединений в пуле */
    max: number;
    /** Время неактивности соединения в миллисекундах */
    idleTimeoutMillis: number;
    /** Таймаут установки соединения в миллисекундах */
    connectionTimeoutMillis: number;
  };
  /** Настройки логирования */
  logging: {
    /** Включить логирование SQL запросов */
    enabled: boolean;
    /** Порог для медленных запросов в миллисекундах */
    slowQueryThreshold: number;
  };
  /** Настройки миграций */
  migrations: {
    /** Директория с файлами миграций */
    directory: string;
    /** Название таблицы для отслеживания миграций */
    tableName: string;
  };
  /** Настройки заполнения данными */
  seed: {
    /** Включить автоматическое заполнение */
    enabled: boolean;
    /** Файл с данными для заполнения */
    file: string;
  };
}

/**
 * Конфигурация Prisma клиента
 *
 * Используется для настройки Prisma ORM
 */
export interface PrismaConfig {
  /** Настройки клиента */
  client: {
    /** Уровни логирования (query, info, warn, error) */
    log: string[];
    /** Формат ошибок */
    errorFormat: string;
  };
  /** URL основной базы данных */
  databaseUrl: string;
  /** URL теневой базы данных (для миграций) */
  shadowDatabaseUrl?: string;
}

/**
 * Статистика базы данных
 *
 * Содержит количество записей в основных таблицах
 * Используется для мониторинга и аналитики
 */
export interface DatabaseStats {
  /** Количество пользователей */
  users: number;
  /** Количество карточек */
  cards: number;
  /** Количество наборов */
  sets: number;
  /** Количество наборов пользователей */
  userSets: number;
}

/**
 * Результат проверки здоровья базы данных
 *
 * Используется для мониторинга доступности БД
 */
export interface HealthCheckResult {
  /** Статус проверки */
  status: 'ok' | 'error';
  /** Сообщение об ошибке (если есть) */
  message?: string;
}
