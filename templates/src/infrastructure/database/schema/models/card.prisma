/// Карточка для изучения
/// 
/// Основная модель для хранения карточек с словами и фразами.
/// Поддерживает различные типы контента: слова, фразы, глаголы.
/// Может быть глобальной (доступной всем) или пользовательской.
model Card {
  /// Уникальный идентификатор карточки
  id            String @id @default(cuid())
  
  /// Дата и время создания карточки
  createdAt     DateTime @default(now())
  
  /// Дата и время последнего обновления карточки
  updatedAt     DateTime @updatedAt

  /// Слово или фраза для изучения
  wordOrPhrase  String
  
  /// URL-дружественный идентификатор
  slug          String
  
  /// Часть речи (NOUN, VERB, ADJECTIVE, etc.)
  partOfSpeech  PartOfSpeech?
  
  /// Фонетическая транскрипция
  transcription String?
  
  /// URL изображения для карточки
  imageUrl      String?
  
  /// URL аудио файла с произношением
  audioUrl      String?
  
  /// Глобальная карточка (доступна всем пользователям)
  isGlobal      Boolean  @default(true) 
  
  /// Грамматический род (для немецкого: MASCULINE, FEMININE, NEUTER)
  grammaticalGender String?
  
  /// Сложность карточки
  difficulty    CardDifficulty?
  
  /// Тип контента карточки
  contentType   ContentType?
  
  /// Статус контента карточки
  contentStatus ContentStatus? @default(DRAFT)
  
  /// ID пользователя, создавшего карточку (для пользовательских карточек)
  userId        String?
  
  /// Связь с пользователем
  user          User?    @relation(fields: [userId], references: [id], onDelete: Cascade)

  /// ID языка карточки
  languageId    String?
  
  /// Связь с языком
  language      Language? @relation(fields: [languageId], references: [id], onDelete: SetNull)

  /// Уровень сложности (A1, A2, B1, B2, C1, C2)
  level         LanguageLevel?

  /// ID грамматического правила
  ruleId        String?
  
  /// Связь с грамматическим правилом
  rule          GrammarRule? @relation(fields: [ruleId], references: [id], onDelete: SetNull)

  /// Тип глагола (только для partOfSpeech = VERB)
  verbType        VerbType?
  
  /// ID неправильного глагола (только для IRREGULAR/MIXED/MODAL/AUXILIARY/PHRASAL/COMPOUND)
  irregularVerbId String?
  
  /// Связь с неправильным глаголом
  irregularVerb   IrregularVerb? @relation(fields: [irregularVerbId], references: [id], onDelete: SetNull)

  /// Провайдер источника данных (например, "dictionary-api")
  sourceProvider String?
  
  /// ID в источнике данных
  sourceId       String?
  
  /// Количество добавлений карточки в наборы для изучения
  studyCount     Int @default(0)
  
  /// Количество просмотров карточки
  viewCount      Int @default(0)
  
  /// Дата и время последнего использования
  lastUsedAt     DateTime?

  // Связи с другими моделями
  /// Определения карточки
  definitions   Definition[] @relation("cards_definitions")
  
  /// Примеры использования
  examples      Example[] @relation("cards_examples")
  
  /// Карточки пользователей
  userCards     UserCard[]
  
  /// Наборы, содержащие эту карточку
  sets          Set[] @relation("sets_cards")

  @@map("cards")
  @@unique([slug, languageId, sourceProvider, sourceId])
  @@index([languageId, level, isGlobal])
  @@index([wordOrPhrase])
  @@index([userId, isGlobal])
  @@index([studyCount])
  @@index([viewCount])
}
